<div class="resource-container">
  <!-- Multiple versions mode with sidebar layout -->
  <ng-container *ngIf="hasMultipleVersions">
    <h2>Resource: {{ resourceId }}</h2>

    <div class="resource-layout">
      <!-- Main content area -->
      <div class="main-content">
        <div *ngIf="defaultVersion$ | async as defaultVersion" class="default-version-section">
          <h3>Default Version: {{ defaultVersion.id }}</h3>
          <div class="origin-field" *ngIf="defaultVersion.origin">Origin: {{ defaultVersion.origin }}</div>
          <a [routerLink]="['versions', defaultVersion['versionid'] || defaultVersion['id']]" class="btn-view">View Version Details</a>
          <app-resource-document
            [resourceDocument]="defaultVersion"
            [resourceType]="resourceType"
            [resourceAttributes]="resourceAttributes"
            [hasDocumentSupport]="resourceTypeData?.hasdocument"
            [showAttributes]="true"
            [showDocument]="true"
            [initialExpanded]="true">
          </app-resource-document>
        </div>
      </div>

      <!-- Version History Sidebar -->
      <div class="versions-sidebar">
        <div class="sidebar-header">
          <h3>Version History</h3>
          <app-pagination
            *ngIf="pageLinks && (pageLinks.first || pageLinks.prev || pageLinks.next || pageLinks.last)"
            [links]="pageLinks"
            (pageChange)="onVersionPageChange($event)">
          </app-pagination>
        </div>

        <div class="versions-list-compact">
          <div *ngFor="let v of versionsList"
               class="version-item"
               [class.default-version]="v.isDefault">
            <div class="version-header">
              <span class="version-id">{{ v.id || v.versionid }}</span>
              <span *ngIf="v.isDefault" class="default-badge">Default</span>
            </div>
            <div class="version-meta">
              <small>Modified: {{ (v.modifiedAt || v.modifiedat) | date:'short' }}</small>
            </div>
            <a [routerLink]="['versions', v.id || v.versionid]" class="btn-view-compact">View</a>
          </div>

          <div *ngIf="versionsList.length === 0" class="no-versions">
            <p>No version history available.</p>
          </div>
        </div>
      </div>
    </div>
  </ng-container>

  <!-- Single version mode -->
  <ng-container *ngIf="!hasMultipleVersions && (defaultVersion$ | async) as version">
    <h2>Resource: {{ resourceId }}</h2>
    <div class="version-detail">
      <h3>Version: {{ version.id }}</h3>

      <!-- Use our new shared component -->      <app-resource-document
        [resourceDocument]="version"
        [resourceType]="resourceType"
        [resourceAttributes]="resourceAttributes"
        [hasDocumentSupport]="resourceTypeData?.hasdocument"
        [showAttributes]="true"
        [showDocument]="true"
        [initialExpanded]="true">
      </app-resource-document>
    </div>
  </ng-container>

  <div *ngIf="loading" class="loading-container">
    <h2>Loading resource...</h2>
  </div>
</div>
