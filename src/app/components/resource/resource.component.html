<div class="resource-container">
  <!-- Multiple versions mode -->
  <ng-container *ngIf="hasMultipleVersions">
    <h2>Resource: {{ resourceId }}</h2>

    <!-- Version History -->
    <div class="versions-list">
      <h3>Version History</h3>
      <app-pagination *ngIf="pageLinks && (pageLinks.first || pageLinks.prev || pageLinks.next || pageLinks.last)" [links]="pageLinks" (pageChange)="onVersionPageChange($event)"></app-pagination>
      <table>
        <thead>
          <tr>
            <th>Version ID</th>
            <th>Created</th>
            <th>Modified</th>
            <th>Default</th>
            <th>Origin</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let v of versionsList" [class.default-version]="v.isDefault">
            <td>{{ v.id || v.versionid }}</td>
            <td>{{ (v.createdAt || v.createdat) | date:'short' }}</td>
            <td>{{ (v.modifiedAt || v.modifiedat) | date:'short' }}</td>
            <td><span *ngIf="v.isDefault" class="default-badge">âœ“</span></td>
            <td>{{ v.origin }}</td>
            <td><a [routerLink]="['versions', v.id || v.versionid]" class="btn-view">View</a></td>
          </tr>
        </tbody>
      </table>
      <ng-template #noVersions>
        <p>No version history available.</p>
      </ng-template>
    </div>

    <!-- Always show default version too -->
    <div *ngIf="defaultVersion$ | async as defaultVersion" class="latest-version">
      <h3>Default Version: {{ defaultVersion.id }}</h3>
      <div class="origin-field" *ngIf="defaultVersion.origin">Origin: {{ defaultVersion.origin }}</div>
      <a [routerLink]="['versions', defaultVersion['versionid'] || defaultVersion['id']]" class="btn-view">View Version Details</a>
      <app-resource-document
        [resourceDocument]="defaultVersion"
        [resourceType]="resourceType"
        [resourceAttributes]="resourceAttributes"
        [hasDocumentSupport]="resourceTypeData?.hasdocument"
        [showAttributes]="true"
        [showDocument]="true"
        [initialExpanded]="true">
      </app-resource-document>
    </div>
  </ng-container>

  <!-- Single version mode -->
  <ng-container *ngIf="!hasMultipleVersions && (defaultVersion$ | async) as version">
    <h2>Resource: {{ resourceId }}</h2>
    <div class="version-detail">
      <h3>Version: {{ version.id }}</h3>

      <!-- Use our new shared component -->      <app-resource-document
        [resourceDocument]="version"
        [resourceType]="resourceType"
        [resourceAttributes]="resourceAttributes"
        [hasDocumentSupport]="resourceTypeData?.hasdocument"
        [showAttributes]="true"
        [showDocument]="true"
        [initialExpanded]="true">
      </app-resource-document>
    </div>
  </ng-container>

  <div *ngIf="loading" class="loading-container">
    <h2>Loading resource...</h2>
  </div>
</div>
